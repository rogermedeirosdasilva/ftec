(function(){var g,ht,ct,lt,at,vt,yt,pt,l,wt,bt,nt,kt,dt,e,gt,i,a,v,tt,o,y,ni,it,rt,u,ti,r,n,p,ut,ii,s,ft,w,t,f,et,h,b,ot,k,d,ri,ui,st,fi,ei,c=[].slice,oi={}.hasOwnProperty,si=function(n,t){function r(){this.constructor=n}for(var i in t)oi.call(t,i)&&(n[i]=t[i]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n},hi=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1};for(tt={catchupTime:500,initialRate:.03,minTime:500,ghostTime:500,maxProgressPerFrame:10,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:500,target:"body",elements:{checkInterval:100,selectors:["body"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:["GET"],trackWebSockets:!0,ignoreURLs:[]}},r=function(){var n;return(n=typeof performance!="undefined"&&performance!==null?typeof performance.now=="function"?performance.now():void 0:void 0)!=null?n:+new Date},p=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,v=window.cancelAnimationFrame||window.mozCancelAnimationFrame,p==null&&(p=function(n){return setTimeout(n,50)},v=function(n){return clearTimeout(n)}),ii=function(n){var i,t;return i=r(),t=function(){var u;return u=r()-i,u>=33?(i=r(),n(u,function(){return p(t)})):setTimeout(t,33-u)},t()},ut=function(){var i,t,n;return n=arguments[0],t=arguments[1],i=3<=arguments.length?c.call(arguments,2):[],typeof n[t]=="function"?n[t].apply(n,i):n[t]},o=function(){var n,t,i,f,r,u,e;for(t=arguments[0],f=2<=arguments.length?c.call(arguments,1):[],u=0,e=f.length;u<e;u++)if(i=f[u],i)for(n in i)oi.call(i,n)&&(r=i[n],t[n]!=null&&typeof t[n]=="object"&&r!=null&&typeof r=="object"?o(t[n],r):t[n]=r);return t},gt=function(n){var i,r,u,t,f;for(r=i=0,t=0,f=n.length;t<f;t++)u=n[t],r+=Math.abs(u),i++;return r/i},ni=function(n,t){var i,u,r;if(n==null&&(n="options"),t==null&&(t=!0),r=document.querySelector("[data-pace-"+n+"]"),r){if(i=r.getAttribute("data-pace-"+n),!t)return i;try{return JSON.parse(i)}catch(f){return u=f,typeof console!="undefined"&&console!==null?console.error("Error parsing inline pace options",u):void 0}}},yt=function(){function n(){}return n.prototype.on=function(n,t,i,r){var u;return r==null&&(r=!1),this.bindings==null&&(this.bindings={}),(u=this.bindings)[n]==null&&(u[n]=[]),this.bindings[n].push({handler:t,ctx:i,once:r})},n.prototype.once=function(n,t,i){return this.on(n,t,i,!0)},n.prototype.off=function(n,t){var i,u,r;if(((u=this.bindings)!=null?u[n]:void 0)!=null){if(t==null)return delete this.bindings[n];for(i=0,r=[];i<this.bindings[n].length;)this.bindings[n][i].handler===t?r.push(this.bindings[n].splice(i,1)):r.push(i++);return r}},n.prototype.trigger=function(){var f,u,n,e,t,o,s,i,r;if(n=arguments[0],f=2<=arguments.length?c.call(arguments,1):[],(s=this.bindings)!=null?s[n]:void 0){for(t=0,r=[];t<this.bindings[n].length;)i=this.bindings[n][t],e=i.handler,u=i.ctx,o=i.once,e.apply(u!=null?u:this,f),o?r.push(this.bindings[n].splice(t,1)):r.push(t++);return r}},n}(),window.Pace==null&&(window.Pace={}),o(Pace,yt.prototype),n=Pace.options=o({},tt,window.paceOptions,ni()),st=["ajax","document","eventLag","elements"],k=0,ri=st.length;k<ri;k++)t=st[k],n[t]===!0&&(n[t]=tt[t]);l=function(n){function t(){return fi=t.__super__.constructor.apply(this,arguments)}return si(t,n),t}(Error);ht=function(){function t(){this.progress=0}return t.prototype.getElement=function(){var t;if(this.el==null){if(t=document.querySelector(n.target),!t)throw new l;this.el=document.createElement("div");this.el.className="pace pace-active";document.body.className=document.body.className.replace(/pace-done/g,"");document.body.className+=" pace-running";this.el.innerHTML='<div class="pace-progress">\n  <div class="pace-progress-inner"><\/div>\n<\/div>\n<div class="pace-activity"><\/div>';t.firstChild!=null?t.insertBefore(this.el,t.firstChild):t.appendChild(this.el)}return this.el},t.prototype.finish=function(){var n;return n=this.getElement(),n.className=n.className.replace("pace-active",""),n.className+=" pace-inactive",document.body.className=document.body.className.replace("pace-running",""),document.body.className+=" pace-done"},t.prototype.update=function(n){return this.progress=n,this.render()},t.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(n){l=n}return this.el=void 0},t.prototype.render=function(){var t,i;return document.querySelector(n.target)==null?!1:(t=this.getElement(),t.children[0].style.width=""+this.progress+"%",(!this.lastRenderedProgress||this.lastRenderedProgress|0!==this.progress|0)&&(t.children[0].setAttribute("data-progress-text",""+(this.progress|0)+"%"),i=this.progress>=100?"99":(this.progress<10?"0":"")+(this.progress|0),t.children[0].setAttribute("data-progress",""+i)),this.lastRenderedProgress=this.progress)},t.prototype.done=function(){return this.progress>=100},t}();pt=function(){function n(){this.bindings={}}return n.prototype.trigger=function(n,t){var f,i,e,r,u;if(this.bindings[n]!=null){for(r=this.bindings[n],u=[],i=0,e=r.length;i<e;i++)f=r[i],u.push(f.call(this,t));return u}},n.prototype.on=function(n,t){var i;return(i=this.bindings)[n]==null&&(i[n]=[]),this.bindings[n].push(t)},n}();ot=window.XMLHttpRequest;b=window.XDomainRequest;h=window.WebSocket;y=function(n,t){var f,i,r,u=[];for(i in t.prototype)try{r=t.prototype[i];n[i]==null&&typeof r!="function"?u.push(n[i]=r):u.push(void 0)}catch(e){f=e}return u};u=[];Pace.ignore=function(){var n,t,i;return t=arguments[0],n=2<=arguments.length?c.call(arguments,1):[],u.unshift("ignore"),i=t.apply(null,n),u.shift(),i};Pace.track=function(){var n,t,i;return t=arguments[0],n=2<=arguments.length?c.call(arguments,1):[],u.unshift("track"),i=t.apply(null,n),u.shift(),i};w=function(t){var i;return(t==null&&(t="GET"),u[0]==="track")?"force":!u.length&&n.ajax&&(t==="socket"&&n.ajax.trackWebSockets||(i=t.toUpperCase(),hi.call(n.ajax.trackMethods,i)>=0))?!0:!1};wt=function(t){function i(){var t,r=this;i.__super__.constructor.apply(this,arguments);t=function(n){var t;return t=n.open,n.open=function(i,u){return w(i)&&r.trigger("request",{type:i,url:u,request:n}),t.apply(n,arguments)}};window.XMLHttpRequest=function(n){var i;return i=new ot(n),t(i),i};try{y(window.XMLHttpRequest,ot)}catch(u){}if(b!=null){window.XDomainRequest=function(){var n;return n=new b,t(n),n};try{y(window.XDomainRequest,b)}catch(u){}}if(h!=null&&n.ajax.trackWebSockets){window.WebSocket=function(n,t){var i;return i=t!=null?new h(n,t):new h(n),w("socket")&&r.trigger("request",{type:"socket",url:n,protocols:t,request:i}),i};try{y(window.WebSocket,h)}catch(u){}}}return si(i,t),i}(pt);d=null;it=function(){return d==null&&(d=new wt),d};ft=function(t){var i,r,f,u;for(u=n.ajax.ignoreURLs,r=0,f=u.length;r<f;r++)if(i=u[r],typeof i=="string"){if(t.indexOf(i)!==-1)return!0}else if(i.test(t))return!0;return!1};it().on("request",function(i){var r,e,u,f,o;if(f=i.type,u=i.request,o=i.url,!ft(o))return!Pace.running&&(n.restartOnRequestAfter!==!1||w(f)==="force")?(e=arguments,r=n.restartOnRequestAfter||0,typeof r=="boolean"&&(r=0),setTimeout(function(){var o,n,s,h,i,r;if(o=f==="socket"?u.readyState<2:0<(h=u.readyState)&&h<4,o){for(Pace.restart(),i=Pace.sources,r=[],n=0,s=i.length;n<s;n++)if(t=i[n],t instanceof g){t.watch.apply(t,e);break}else r.push(void 0);return r}},r)):void 0});g=function(){function n(){var n=this;this.elements=[];it().on("request",function(){return n.watch.apply(n,arguments)})}return n.prototype.watch=function(n){var t,i,r,u;if(r=n.type,t=n.request,u=n.url,!ft(u))return i=r==="socket"?new kt(t):new dt(t),this.elements.push(i)},n}();dt=function(){function n(n){var f,o,i,e,r,u,t=this;if(this.progress=0,window.ProgressEvent!=null)for(o=null,n.addEventListener("progress",function(n){return t.progress=n.lengthComputable?100*n.loaded/n.total:t.progress+(100-t.progress)/2}),u=["load","abort","timeout","error"],i=0,e=u.length;i<e;i++)f=u[i],n.addEventListener(f,function(){return t.progress=100});else r=n.onreadystatechange,n.onreadystatechange=function(){var i;return(i=n.readyState)===0||i===4?t.progress=100:n.readyState===3&&(t.progress=50),typeof r=="function"?r.apply(null,arguments):void 0}}return n}();kt=function(){function n(n){var r,t,u,i,f=this;for(this.progress=0,i=["error","open"],t=0,u=i.length;t<u;t++)r=i[t],n.addEventListener(r,function(){return f.progress=100})}return n}();lt=function(){function n(n){var r,t,u,i;for(n==null&&(n={}),this.elements=[],n.selectors==null&&(n.selectors=[]),i=n.selectors,t=0,u=i.length;t<u;t++)r=i[t],this.elements.push(new at(r))}return n}();at=function(){function t(n){this.selector=n;this.progress=0;this.check()}return t.prototype.check=function(){var t=this;return document.querySelector(this.selector)?this.done():setTimeout(function(){return t.check()},n.elements.checkInterval)},t.prototype.done=function(){return this.progress=100},t}();ct=function(){function n(){var n,i,t=this;this.progress=(i=this.states[document.readyState])!=null?i:100;n=document.onreadystatechange;document.onreadystatechange=function(){return t.states[document.readyState]!=null&&(t.progress=t.states[document.readyState]),typeof n=="function"?n.apply(null,arguments):void 0}}return n.prototype.states={loading:0,interactive:50,complete:100},n}();vt=function(){function t(){var i,f,u,e,t,o=this;this.progress=0;i=0;t=[];e=0;u=r();f=setInterval(function(){var s;return s=r()-u-50,u=r(),t.push(s),t.length>n.eventLag.sampleCount&&t.shift(),i=gt(t),++e>=n.eventLag.minSamples&&i<n.eventLag.lagThreshold?(o.progress=100,clearInterval(f)):o.progress=300/(i+3)},50)}return t}();nt=function(){function t(t){this.source=t;this.last=this.sinceLastUpdate=0;this.rate=n.initialRate;this.catchup=0;this.progress=this.lastProgress=0;this.source!=null&&(this.progress=ut(this.source,"progress"))}return t.prototype.tick=function(t,i){var r;return i==null&&(i=ut(this.source,"progress")),i>=100&&(this.done=!0),i===this.last?this.sinceLastUpdate+=t:(this.sinceLastUpdate&&(this.rate=(i-this.last)/this.sinceLastUpdate),this.catchup=(i-this.progress)/n.catchupTime,this.sinceLastUpdate=0,this.last=i),i>this.progress&&(this.progress+=this.catchup*t),r=1-Math.pow(this.progress/100,n.easeFactor),this.progress+=r*this.rate*t,this.progress=Math.min(this.lastProgress+n.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},t}();f=null;s=null;i=null;et=null;e=null;a=null;Pace.running=!1;rt=function(){if(n.restartOnPushState)return Pace.restart()};window.history.pushState!=null&&(ui=window.history.pushState,window.history.pushState=function(){return rt(),ui.apply(window.history,arguments)});window.history.replaceState!=null&&(ei=window.history.replaceState,window.history.replaceState=function(){return rt(),ei.apply(window.history,arguments)});bt={ajax:g,elements:lt,document:ct,eventLag:vt};(ti=function(){var r,u,e,c,l,o,a,h;for(Pace.sources=f=[],o=["ajax","elements","document","eventLag"],u=0,c=o.length;u<c;u++)r=o[u],n[r]!==!1&&f.push(new bt[r](n[r]));for(h=(a=n.extraSources)!=null?a:[],e=0,l=h.length;e<l;e++)t=h[e],f.push(new t(n));return Pace.bar=i=new ht,s=[],et=new nt})();Pace.stop=function(){return Pace.trigger("stop"),Pace.running=!1,i.destroy(),a=!0,e!=null&&(typeof v=="function"&&v(e),e=null),ti()};Pace.restart=function(){return Pace.trigger("restart"),Pace.stop(),Pace.start()};Pace.go=function(){var u;return Pace.running=!0,i.render(),u=r(),a=!1,e=ii(function(e,o){var g,y,p,tt,w,h,c,ft,l,v,b,k,d,it,rt,ut;for(ft=100-i.progress,y=b=0,p=!0,h=k=0,it=f.length;k<it;h=++k)for(t=f[h],v=s[h]!=null?s[h]:s[h]=[],w=(ut=t.elements)!=null?ut:[t],c=d=0,rt=w.length;d<rt;c=++d)(tt=w[c],l=v[c]!=null?v[c]:v[c]=new nt(tt),p&=l.done,l.done)||(y++,b+=l.tick(e));return g=b/y,i.update(et.tick(e,g)),i.done()||p||a?(i.update(100),Pace.trigger("done"),setTimeout(function(){return i.finish(),Pace.running=!1,Pace.trigger("hide")},Math.max(n.ghostTime,Math.max(n.minTime-(r()-u),0)))):o()})};Pace.start=function(t){o(n,t);Pace.running=!0;try{i.render()}catch(r){l=r}return document.querySelector(".pace")?(Pace.trigger("start"),Pace.go()):setTimeout(Pace.start,50)};typeof define=="function"&&define.amd?define(function(){return Pace}):typeof exports=="object"?module.exports=Pace:n.startOnPageLoad&&Pace.start()}).call(this);